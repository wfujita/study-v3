# 数学ドリルの回答送信フロー

このドキュメントでは、数学ドリルで入力した回答がどのように送信・保存されるかをまとめます。

## フロントエンドでの処理

- `app/static/math.html` では、表示された解答欄に入力した値を `state.inputs` から取得し、`答え合わせ` ボタン押下時に採点します。
- 採点時には問題 ID・難易度・正誤判定・入力値などをまとめたオブジェクトを `sendMathResult` で生成し、JSON 形式のリクエストボディとして `/api/results` に POST します。
- 送信前後にステータスメッセージを表示し、成功時は「採点結果を記録しました。」、失敗時は再試行を促すメッセージを表示します。

## バックエンドでの処理

- Flask アプリケーションの `/api/results` エンドポイントでは、受信した JSON に `subject` や `receivedAt` を補完して `data/<subject>/results.ndjson` に 1 行ずつ追記します。
- 追加でのファイル保存やバイナリ解析は行わず、送信された回答内容をそのまま記録します。
- `app/static/math-results.html` からは `/api/math/results` を通じて最新の提出履歴を参照でき、各回答の正誤や難易度を確認できます。

## 備考

現時点では PDF や画像などのアップロード機能は提供しておらず、ブラウザから入力したテキスト回答のみをサーバーへ送信します。
